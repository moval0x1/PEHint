# AppVeyor configuration for Qt + CMake project
version: 1.0.{build}

# OS and image
image: Visual Studio 2022

# Environment setup
environment:
  matrix:
    - QT_DIR: "C:\\Qt\\6.5.2\\msvc2019_64"  # Adjust to your Qt version and installation path
      CMAKE_GENERATOR: "Ninja"             # Use Ninja or Visual Studio generators

# Install dependencies
install:
  - cmd: set PATH=%QT_DIR%\bin;%PATH%      # Add Qt to PATH
  - cmd: choco install cmake --installargs 'ADD_CMAKE_TO_PATH=System' --no-progress

# Build script
build_script:
  - mkdir build
  - cd build
  - cmake -G "%CMAKE_GENERATOR%" ^
      -DCMAKE_PREFIX_PATH="%QT_DIR%" ^
      -DCMAKE_BUILD_TYPE=Release ^
      ..
  - cmake --build . --config Release

# Artifacts (if you want to keep the resulting binaries)
artifacts:
  - path: build\Release\*.exe
    name: PEHint Executable

# Notifications (optional)
notifications:
  email:
    on_failure: always
    on_success: change
