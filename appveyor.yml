# AppVeyor configuration for PEHint project

# Set the environment to Windows
image: Visual Studio 2022

# Define the build matrix
environment:
  matrix:
    - QT_DIR: C:\Qt\6.8.0\msvc2022_64

# Define the build cache to speed up subsequent builds
cache:
  - C:\Qt\6.8.0\msvc2022_64

# Clone the repository
clone_folder: c:\projects\pehint

# Before build: set up environment
before_build:
  # Add Qt bin folder to PATH
  - set PATH=%QT_DIR%\bin;%PATH%
  # Specify CMake prefix path
  - set CMAKE_PREFIX_PATH=%QT_DIR%
  # Debug output for paths
  - echo PATH=%PATH%
  - echo CMAKE_PREFIX_PATH=%CMAKE_PREFIX_PATH%

# Build script
build_script:
  - cmake -B build -S . -DCMAKE_PREFIX_PATH=%CMAKE_PREFIX_PATH% -A x64
  - cmake --build build --config Release

# Artifacts: include the final executable for download
artifacts:
  - path: build\Release\PEHint.exe
    name: PEHint Executable