[SecurityAnalysis]
# Security Analysis Configuration for PEHint
# This file contains all configurable parameters for PE file security analysis
# Modify these settings to customize security detection behavior

[General]
# Overall security analysis settings
default_sensitivity_level = 5
enable_entropy_analysis = true
enable_section_analysis = true
enable_import_analysis = true
enable_resource_analysis = true
enable_digital_signature_validation = true
enable_anti_debug_detection = true
enable_anti_vm_detection = true
enable_packer_detection = true
enable_suspicious_api_detection = true
enable_code_injection_detection = true

[EntropyThresholds]
# Entropy analysis thresholds for detecting packed/obfuscated content
# Values range from 0.0 (no entropy) to 8.0 (maximum entropy)
high_entropy_threshold = 7.5
medium_entropy_threshold = 6.0
low_entropy_threshold = 4.0

# Entropy analysis configuration
entropy_analysis_chunk_size = 1024
entropy_analysis_overlap = 512
enable_section_entropy_analysis = true
enable_header_entropy_analysis = true

[SuspiciousSections]
# Section names that are considered suspicious or potentially malicious
# These patterns are matched against section names during analysis
suspicious_section_patterns = UPX, PACK, CRYPT, ENCRYPT, OBFUSC, PROTECT, SHIELD, GUARD, WRAP, HIDE

# Section characteristics that indicate potential security issues
suspicious_section_characteristics = 0xE0000000, 0xC0000000, 0x80000000

# Maximum section size threshold (in bytes) - sections larger than this are flagged
max_section_size_threshold = 10485760

# Suspicious section permissions combinations
suspicious_permissions = RWX, RWX, EXECUTE_READ_WRITE

[AntiDebugTechniques]
# Anti-debugging APIs and techniques to detect
anti_debug_apis = IsDebuggerPresent, CheckRemoteDebuggerPresent, OutputDebugStringA, OutputDebugStringW, GetTickCount, QueryPerformanceCounter, GetSystemTime, GetLocalTime, Sleep, GetLastError

# Anti-debugging code patterns
anti_debug_patterns = int3, 0xCC, 0xCD, 0xCE, 0xCF

# Timing-based anti-debugging detection
timing_detection_enabled = true
timing_threshold_ms = 100

[AntiVMTechniques]
# Anti-VM detection strings and patterns
anti_vm_strings = VMware, VBox, VirtualBox, QEMU, Xen, Parallels, HyperV, VirtualPC, Bochs, KVM

# Anti-VM registry keys and paths
anti_vm_registry_keys = SOFTWARE\\VMware, Inc.\\VMware Tools, SOFTWARE\\Oracle\\VirtualBox Guest Additions, SYSTEM\\CurrentControlSet\\Services\\Disk\\Enum

# Anti-VM file paths
anti_vm_file_paths = C:\\WINDOWS\\system32\\drivers\\vmmouse.sys, C:\\WINDOWS\\system32\\drivers\\vmscsi.sys, C:\\WINDOWS\\system32\\vboxhook.dll

# Anti-VM process names
anti_vm_processes = vmtoolsd.exe, VBoxService.exe, VBoxTray.exe, vmwaretray.exe, vmwareuser.exe

[SuspiciousAPIs]
# APIs commonly used in malware and suspicious activities
# These are categorized by threat type for better analysis

[ProcessInjectionAPIs]
# APIs used for process injection and manipulation
process_injection_apis = CreateRemoteThread, WriteProcessMemory, VirtualAllocEx, OpenProcess, SetWindowsHookEx, CreateProcess, NtCreateThreadEx, NtWriteVirtualMemory, NtAllocateVirtualMemory, NtOpenProcess

[NetworkAPIs]
# APIs used for network communication (potential C&C, data exfiltration)
network_apis = WSAConnect, connect, send, recv, HttpOpenRequestA, HttpOpenRequestW, InternetConnectA, InternetConnectW, URLDownloadToFileA, URLDownloadToFileW, WinHttpOpen, WinHttpConnect, WinHttpSendRequest

[RegistryAPIs]
# APIs used for registry manipulation
registry_apis = RegCreateKeyExA, RegCreateKeyExW, RegSetValueExA, RegSetValueExW, RegDeleteValueA, RegDeleteValueW, RegOpenKeyExA, RegOpenKeyExW, RegQueryValueExA, RegQueryValueExW, RegEnumKeyExA, RegEnumKeyExW

[FileSystemAPIs]
# APIs used for file system operations (potential data theft, persistence)
filesystem_apis = CreateFileA, CreateFileW, WriteFile, ReadFile, DeleteFileA, DeleteFileW, MoveFileA, MoveFileW, CopyFileA, CopyFileW, SetFileAttributesA, SetFileAttributesW

[SystemAPIs]
# APIs used for system manipulation and privilege escalation
system_apis = CreateServiceA, CreateServiceW, StartServiceA, StartServiceW, OpenSCManagerA, OpenSCManagerW, CreateProcessAsUserA, CreateProcessAsUserW, ImpersonateLoggedOnUser, RevertToSelf

[CodeInjectionTechniques]
# Code injection and manipulation techniques to detect
code_injection_patterns = CreateRemoteThread, WriteProcessMemory, VirtualAllocEx, SetWindowsHookEx, QueueUserAPC, NtCreateThreadEx

# Suspicious DLL injection patterns
dll_injection_patterns = LoadLibraryA, LoadLibraryW, GetProcAddress, FreeLibrary, CreateRemoteThread, VirtualAllocEx, WriteProcessMemory

[PackerSignatures]
# Known packer and obfuscator signatures
packer_signatures = UPX, ASPack, PECompact, Themida, VMProtect, Armadillo, Obsidium, Enigma, SmartAssembly, Confuser, Dotfuscator, ILProtector

# Packer detection patterns
packer_patterns = UPX!, ASPack, PECompact, Themida, VMProtect, Armadillo, Obsidium, Enigma

[ResourceAnalysis]
# Resource types to analyze for security concerns
suspicious_resource_types = RT_RCDATA, RT_STRING, RT_VERSION, RT_MANIFEST, RT_HTML, RT_XML

# Resource names that might indicate malicious content
suspicious_resource_names = config, settings, data, payload, shellcode, encrypted, packed, obfuscated

# Maximum resource size threshold (in bytes)
max_resource_size_threshold = 5242880

[DigitalSignature]
# Digital signature validation settings
enable_signature_validation = true
check_certificate_revocation = true
validate_timestamp = true
trusted_publishers_only = false

# Certificate validation settings
min_certificate_strength = 128
check_certificate_expiry = true
check_certificate_chain = true

[RiskScoring]
# Risk scoring algorithm configuration
# Points awarded for different types of security issues

# Critical issues (highest risk)
critical_issue_points = 25
critical_issues = file_not_found, file_not_readable, invalid_pe_structure, invalid_dos_header, file_too_small

# High risk issues
high_risk_points = 15
high_risk_issues = high_entropy, packed_file, anti_debug_detected, anti_vm_detected, suspicious_section, large_section

# Medium risk issues
medium_risk_points = 10
medium_risk_issues = moderate_entropy, suspicious_imports, process_injection_apis, network_apis, registry_apis

# Low risk issues
low_risk_points = 5
low_risk_issues = suspicious_resource, unusual_characteristics, non_standard_extension

# Bonus points for multiple issues of the same type
multiple_issues_bonus = true
critical_multiple_bonus = 10
high_multiple_bonus = 8
medium_multiple_bonus = 5
low_multiple_bonus = 3

# Risk level thresholds
critical_risk_threshold = 80
high_risk_threshold = 60
medium_risk_threshold = 40
low_risk_threshold = 20

[Reporting]
# Security analysis reporting configuration
include_technical_details = true
include_recommendations = true
include_risk_score = true
include_entropy_analysis = true
include_section_analysis = true
include_import_analysis = true
include_resource_analysis = true
include_anti_analysis_detection = true

# Report format options
default_report_format = text
available_formats = text, html, json, xml

# Language settings
default_language = en
available_languages = en, es, fr, de, it, pt, ru, ja, ko, zh

[Performance]
# Performance tuning settings
enable_progress_reporting = true
progress_update_interval_ms = 100
enable_async_analysis = true
max_analysis_threads = 4
enable_caching = true
cache_expiry_hours = 24

[Logging]
# Logging configuration for security analysis
enable_logging = true
log_level = info
log_file_path = logs/security_analysis.log
max_log_file_size_mb = 10
max_log_files = 5
log_timestamp_format = yyyy-MM-dd hh:mm:ss

# Log categories
log_entropy_analysis = true
log_section_analysis = true
log_import_analysis = true
log_anti_analysis_detection = true
log_risk_scoring = true
log_performance_metrics = true
